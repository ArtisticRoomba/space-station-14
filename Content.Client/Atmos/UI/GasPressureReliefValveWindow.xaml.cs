using System.Globalization;
using Robust.Client.AutoGenerated;
using Robust.Client.UserInterface.CustomControls;
using Robust.Client.UserInterface.XAML;

namespace Content.Client.Atmos.UI;

/// <summary>
/// Client-side UI for controlling a gas pressure relief valve.
/// </summary>
[GenerateTypedNameReferences]
public sealed partial class GasPressureReliefValveWindow : DefaultWindow
{
    public event Action<string>? ThresholdPressureChanged;

    public GasPressureReliefValveWindow()
    {
        RobustXamlLoader.Load(this);

        ThresholdInput.OnTextChanged += _ => SetThresholdButton.Disabled = false;
        SetThresholdButton.OnPressed += _ =>
        {
            ThresholdPressureChanged?.Invoke(ThresholdInput.Text ??= "");
            SetThresholdButton.Disabled = true;
        };

    }

    public void SetThreshold(float threshold)
    {
        ThresholdInput.Text = threshold.ToString(CultureInfo.CurrentCulture);
    }
}
